<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hacker SimÃ¼latÃ¶rÃ¼</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #000;
            color: #00ff00; /* Klasik yeÅŸil hacker rengi */
            font-family: 'Consolas', 'Courier New', monospace; /* Daha CMD benzeri font */
            overflow: hidden;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .container {
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        .loader {
            font-size: 8rem;
            animation: spin 2s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .main-menu {
            display: none;
            text-align: center;
            width: 100%;
            padding: 20px;
        }

        .welcome {
            position: absolute;
            top: 50px;
            left: 50px;
            font-size: 2rem;
            color: #00ff00;
            text-shadow: none; /* CMD'de gÃ¶lge olmaz */
        }

        .menu-options {
            font-size: 1.5rem;
            margin-top: 100px;
        }

        .menu-item {
            margin: 20px 0;
            cursor: pointer;
            padding: 10px;
            border: 2px solid transparent;
            transition: all 0.1s; /* Daha hÄ±zlÄ± geÃ§iÅŸ */
        }

        .menu-item:hover {
            border: 2px solid #00ff00;
            background: rgba(0, 255, 0, 0.1);
            text-shadow: 0 0 5px #00ff00; /* Hafif bir parÄ±ltÄ± bÄ±rakabiliriz */
        }

        .game-screen {
            display: none;
            padding: 10px; /* Daha az padding, CMD hissi iÃ§in */
            width: 95%; /* Biraz daha dar */
            height: 95vh; /* YÃ¼ksekliÄŸi ekranÄ±n bÃ¼yÃ¼k kÄ±smÄ±nÄ± kaplasÄ±n */
            overflow-y: auto;
            background: #000; /* Tamamen siyah */
            color: #00ff00;
            border: none; /* Ã‡erÃ§eve yok */
            border-radius: 0; /* KÃ¶ÅŸeler dÃ¼z */
            box-shadow: none; /* GÃ¶lge yok */
        }

        .terminal {
            background: #000; /* Tamamen siyah */
            padding: 0; /* Kendi iÃ§ padding'i olmayacak */
            border-radius: 0;
            min-height: 100%; /* Tam yÃ¼ksekliÄŸi kaplasÄ±n */
            box-shadow: none;
        }

        .story-text {
            font-size: 1.1rem; /* Hafif kÃ¼Ã§Ã¼ltme */
            line-height: 1.5;
            margin-bottom: 10px;
            white-space: pre-wrap;
            word-break: break-word; /* Uzun kelimeleri kÄ±r */
            padding: 0 5px; /* Kenarlardan biraz boÅŸluk */
        }

        .input-area {
            margin-top: 10px;
            display: flex;
            align-items: flex-start; /* Prompt Ã¼stte kalsÄ±n */
            padding: 0 5px;
        }

        .prompt {
            color: #ffffff; /* Prompt beyaz olsun (CMD'de genelde beyaz veya aÃ§Ä±k gri) */
            margin-right: 8px;
            flex-shrink: 0; /* Prompt kÃ¼Ã§Ã¼lmesin */
            font-weight: bold; /* Daha belirgin */
        }

        input {
            background: transparent;
            border: none;
            color: #00ff00;
            font-family: 'Consolas', 'Courier New', monospace;
            font-size: 1.1rem;
            outline: none;
            flex: 1;
            caret-color: #00ff00;
            padding: 0; /* Ekstra padding olmasÄ±n */
        }

        .back-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: transparent;
            border: 1px solid #ff0000; /* Ä°nce kÄ±rmÄ±zÄ± Ã§erÃ§eve */
            color: #ff0000;
            padding: 5px 10px;
            cursor: pointer;
            font-family: 'Consolas', 'Courier New', monospace;
            border-radius: 0; /* DÃ¼z kÃ¶ÅŸeler */
            transition: all 0.1s;
            z-index: 10;
        }

        .back-btn:hover {
            background: rgba(255, 0, 0, 0.2); /* Hafif kÄ±rmÄ±zÄ± vurgu */
            text-shadow: none;
        }

        .developer-screen {
            display: none;
            text-align: center;
            padding: 50px;
        }

        .dev-info {
            font-size: 1.8rem; /* Biraz kÃ¼Ã§Ã¼ltme */
            margin-bottom: 30px;
            text-shadow: none;
        }

        .cursor {
            animation: blink 1s infinite;
        }

        @keyframes blink {
            50% { opacity: 0; }
        }

        .matrix-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 0.07; /* Daha az belirgin */
        }

        .mission-status {
            border: none; /* Ã‡erÃ§eve yok */
            padding: 10px 5px; /* Minimal padding */
            margin: 10px 0;
            background: transparent; /* Arka plan yok */
        }

        .success {
            color: #00ff00;
        }

        .warning {
            color: #ffff00;
        }

        .error {
            color: #ff0000;
        }

        /* Ä°ndirme Ã§ubuÄŸu stili */
        .progress-bar {
            width: 100%;
            background-color: #333;
            border: 1px solid #00ff00;
            height: 20px;
            margin-top: 10px;
        }

        .progress-fill {
            height: 100%;
            width: 0%;
            background-color: #00ff00;
            transition: width 0.1s linear; /* YumuÅŸak geÃ§iÅŸ */
        }
    </style>
</head>
<body>
    <canvas class="matrix-bg" id="matrix"></canvas>

    <div class="container">
        <div class="loader" id="loader">/</div>

        <div class="main-menu" id="mainMenu">
            <div class="welcome">HoÅŸ Geldiniz!</div>
            <div class="menu-options">
                <div class="menu-item" onclick="startGame()">1) Oyuna BaÅŸla</div>
                <div class="menu-item" onclick="showDeveloper()">2) GeliÅŸtirici</div>
            </div>
        </div>

        <div class="game-screen" id="gameScreen">
            <button class="back-btn" onclick="goBack()">â† Geri</button>
            <div class="terminal">
                <div class="story-text" id="storyText"></div>
                <div class="input-area" id="inputArea" style="display: none;">
                    <span class="prompt">C:\USERS\HACKER&gt;</span>
                    <input type="text" id="commandInput" onkeypress="handleCommand(event)" placeholder="">
                </div>
                <div class="mission-status" id="missionStatus" style="display: none;"></div>
                <div class="download-status" id="downloadStatus" style="display: none;">
                    <div class="story-text" id="downloadText"></div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="developer-screen" id="developerScreen">
            <button class="back-btn" onclick="goBack()">â† Geri</button>
            <div class="dev-info">
                <div>ğŸ”° GeliÅŸtirici Bilgileri ğŸ”°</div>
                <br>
                <div style="font-size: 1.5rem;">
                    <div>Yeksoftyekta</div>
                    <br>
                    <div style="color: #ffff00;">Cybersecurity Specialist</div>
                    <div style="color: #ff00ff;">Ethical Hacker & Developer</div>
                    <br>
                    <div style="font-size: 1rem; color: #00ffff;">
                        "Herkese Kodluyorum!"
                    </div>
                </div>
            </div>
        </div>
    </div>

 <audio id="backgroundMusic" src="music.mp3" loop></audio>
<audio id="voiceAudio"></audio>

<script>
    let currentStoryIndex = 0;
    let isDownloading = false;
    let downloadProgress = 0;
    const DOWNLOAD_DURATION = 120000; // 2 minutes (milliseconds)
    const DOWNLOAD_INTERVAL = 100; // Update every 100ms
    const TYPING_SPEED = 60; // Text typing speed (in ms, lower number is faster)

    // Audio elements
    const backgroundMusic = document.getElementById('backgroundMusic');
    const voiceAudio = document.getElementById('voiceAudio');

    // Matrix effect setup
    const canvas = document.getElementById('matrix');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    const characters = '01ï½±ï½²ï½³ï½´ï½µï½¶ï½·ï½¸ï½¹ï½ºï½»ï½¼ï½½ï½¾ï½¿ï¾€ï¾ï¾‚ï¾ƒï¾„ï¾…ï¾†ï¾‡ï¾ˆï¾‰ï¾Šï¾‹ï¾Œï¾ï¾ï¾ï¾ï¾‘ï¾’ï¾“ï¾”ï¾•ï¾–ï¾—ï¾˜ï¾™ï¾šï¾›ï¾œï¾'; // Japanese Katakana and numbers
    const fontSize = 14;
    const columns = canvas.width / fontSize;
    const drops = [];

    // Initialize drops for Matrix effect
    for (let i = 0; i < columns; i++) {
        drops[i] = 1;
    }

    /**
     * Draws the Matrix rain effect on the canvas.
     */
    function drawMatrix() {
        ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        ctx.fillStyle = '#00ff00';
        ctx.font = fontSize + 'px courier new';

        for (let i = 0; i < drops.length; i++) {
            const text = characters.charAt(Math.floor(Math.random() * characters.length));
            ctx.fillText(text, i * fontSize, drops[i] * fontSize);

            // Send drop back to the top when it goes off screen
            if (drops[i] * fontSize * 0.8 > canvas.height && Math.random() > 0.975) {
                drops[i] = 0;
            }
            drops[i]++;
        }
    }

    // Set interval for Matrix effect animation
    setInterval(drawMatrix, 35);

    /**
     * Plays a voice audio file.
     * @param {string} filename The name of the audio file to play (e.g., "audio.wav").
     * @returns {Promise<void>} A Promise that resolves when the audio finishes playing.
     */
    function playVoiceAudio(filename) {
        return new Promise((resolve, reject) => {
            voiceAudio.src = filename;
            voiceAudio.volume = 0.8; // Adjust volume as needed
            voiceAudio.onended = () => resolve(); // Resolve Promise when audio ends
            voiceAudio.onerror = (e) => {
                console.error(`Error playing ${filename}:`, e);
                reject(e);
            };
            voiceAudio.play().catch(e => {
                console.warn(`Auto-play prevented for ${filename}. User interaction might be needed.`, e);
                reject(e); // Reject Promise if playback fails (e.g., autoplay policy)
            });
        });
    }

    /**
     * Plays or pauses the background music.
     * @param {boolean} play True to play, false to pause.
     */
    function toggleBackgroundMusic(play) {
        if (play) {
            backgroundMusic.volume = 0.3; // Lower volume for background music
            backgroundMusic.play().catch(e => {
                console.warn("Background music auto-play prevented. User interaction might be needed.", e);
            });
        } else {
            backgroundMusic.pause();
        }
    }

    // Initial load and menu display
    document.addEventListener('DOMContentLoaded', () => {
        setTimeout(() => {
            document.getElementById('loader').style.display = 'none';
            document.getElementById('mainMenu').style.display = 'block';
            // Attempt to start background music after first user interaction (e.g., loading screen completes)
            toggleBackgroundMusic(true);
        }, 3000);
    });

    /**
     * Starts the game, hides main menu, shows game screen, and starts the story.
     */
    function startGame() {
        document.getElementById('mainMenu').style.display = 'none';
        document.getElementById('gameScreen').style.display = 'block';
        toggleBackgroundMusic(true); // Continue playing music during game
        startStory();
    }

    /**
     * Shows the developer screen.
     */
    function showDeveloper() {
        document.getElementById('mainMenu').style.display = 'none';
        document.getElementById('developerScreen').style.display = 'block';
        toggleBackgroundMusic(true); // Play music on developer screen too
    }

    /**
     * Navigates back to the main menu and resets game state.
     */
    function goBack() {
        document.getElementById('gameScreen').style.display = 'none';
        document.getElementById('developerScreen').style.display = 'none';
        document.getElementById('mainMenu').style.display = 'block';
        currentStoryIndex = 0;
        document.getElementById('inputArea').style.display = 'none';
        document.getElementById('missionStatus').style.display = 'none';
        document.getElementById('downloadStatus').style.display = 'none'; // Reset download status
        isDownloading = false;
        downloadProgress = 0;
        document.getElementById('progressFill').style.width = '0%';
        toggleBackgroundMusic(true); // Continue music on main menu
    }

    // Story data with text and associated audio files
    const storyTexts = [
        {
            text: "SÄ°STEM BAÅLATILIYOR...\n\n[UYARI] Yetkisiz eriÅŸim tespit edildi.\n[BÄ°LGÄ°] GÃ¼venlik protokolleri devreye alÄ±nÄ±yor...\n\nHoÅŸ geldin, genÃ§ hacker.\n\nBenim adÄ±m GHOST, siber dÃ¼nyanÄ±n en gizli organizasyonunun yapay zekasÄ±. Seni buraya getiren sebep basit: dÃ¼nyanÄ±n en bÃ¼yÃ¼k korporasyonu NEXUS CORP'un karanlÄ±k sÄ±rlarÄ±nÄ± aÃ§Ä±ÄŸa Ã§Ä±karmak.\n\nÄ°lk gÃ¶revin: onlarÄ±n gÃ¼venlik duvarÄ±nÄ± aÅŸmak ve gizli dosyalarÄ±na eriÅŸim saÄŸlamak.\n\nHazÄ±r mÄ±sÄ±n? (Devam etmek iÃ§in ENTER'a basÄ±n)",
            audio: "audio.wav"
        },
        {
            text: "GÃ–REV 1: GÄ°RÄ°Å KAPISI\n\n[SÄ°STEM] Target: nexus-corp.com:443\n[DURUM] Hedef sunucu taranÄ±yor...\n\nTarama tamamlandÄ±. AÃ§Ä±k portlar tespit edildi:\n- Port 22 (SSH) - AÃ‡IK\n- Port 80 (HTTP) - AÃ‡IK \n- Port 443 (HTTPS) - AÃ‡IK\n- Port 3389 (RDP) - FÄ°LTRELÄ°\n\nHangi portu kullanarak saldÄ±rÄ±ya geÃ§mek istiyorsun?\nKomut gir: port [numara]",
            audio: "audio2.wav"
        },
        {
            text: "MÃœKEMMEL SEÃ‡Ä°M!\n\n[SÄ°STEM] Port 22 Ã¼zerinden SSH baÄŸlantÄ±sÄ± kuruluyor...\n[BAÅARILI] BaÄŸlantÄ± kuruldu!\n\nÅimdi sisteme giriÅŸ yapmak iÃ§in kullanÄ±cÄ± adÄ± ve ÅŸifre bulmamÄ±z gerekiyor.\nSQL injection saldÄ±rÄ±sÄ± baÅŸlatÄ±lÄ±yor...\n\n[PAYLOAD] admin' OR '1'='1' --\n[SONUÃ‡] GiriÅŸ baÅŸarÄ±lÄ±!\n\n**NEXUS CORP GÄ°ZLÄ° ARÅÄ°VÄ° ERÄ°ÅÄ°LDÄ°**\n\nÄ°Ã§eride neler var bakalÄ±m...\nKomut: 'ls' yazarak dosyalarÄ± listele",
            audio: "audio3.wav"
        },
        {
            text: "DOSYA LÄ°STESÄ°:\n\nğŸ“ classified_projects/\nğŸ“ financial_records/\nğŸ“ employee_data/\nğŸ“ secret_experiments/\nğŸ“„ master_plan.txt\nğŸ“„ backdoor_access.log\n\n[GHOST] Burada Ã§ok kritik bilgiler var. 'secret_experiments' klasÃ¶rÃ¼ Ã§ok ÅŸÃ¼pheli gÃ¶rÃ¼nÃ¼yor.\n\nHangi dosyayÄ± incelemek istiyorsÄ±n?\nKomut: 'open [dosya_adÄ±]' ÅŸeklinde yaz",
            audio: "audio4.wav"
        },
        {
            text: "DOSYA AÃ‡ILIYOR: secret_experiments/\n\nğŸ”´ ÃœST GÄ°ZLÄ° - PROJE PANDORA ğŸ”´\n\n[Ä°Ã‡ERÄ°K]\n- Ä°nsan beynini kontrol eden nanobotlar\n- KÃ¼resel internet aÄŸÄ±na hakimiyet projesi\n- HÃ¼kÃ¼metlerin gizli veritabanlarÄ±na eriÅŸim\n- DÃ¼nya geneli surveillance sistemi\n\n[GHOST] Bu korkunÃ§! NEXUS CORP tÃ¼m dÃ¼nyayÄ± kontrol etmeye Ã§alÄ±ÅŸÄ±yor!\n\nBu bilgileri gÃ¼venli bir yere yedeklememiz gerekiyor.\nKomut: 'download all' yazarak tÃ¼m verileri indir",
            audio: "audio5.wav"
        },
        {
            text: "VERÄ°LER Ä°NDÄ°RÄ°LÄ°YOR...\nLÃ¼tfen bekle. Bu iÅŸlem biraz zaman alabilir.\n",
            audio: "audio6.wav" // Audio to play when download starts
        },
        {
            text: "âœ… TÃœM DOSYALAR GÃœVENLÄ° SUNUCUYA YEDEKLENDÄ°!\n\n[UYARI] Sistem yÃ¶neticisi ÅŸÃ¼pheli aktivite tespit etti!\n[ACÄ°L] IP adresin izleniyor!\n\n[GHOST] HÄ±zlÄ± ol! Åimdi indirdiÄŸimiz verileri analiz etmeliyiz. Neyin iÃ§ine bulaÅŸtÄ±ÄŸÄ±mÄ±zÄ± tam olarak anlamak iÃ§in kritik bir adÄ±m.\n\nKomut: 'analyze data' yazarak verileri analiz et",
            audio: "audio7.wav" // New audio file
        },
        {
            text: "VERÄ° ANALÄ°ZÄ° BAÅLATILIYOR...\n\n[SÄ°STEM] Åifreleme algoritmalarÄ± Ã§Ã¶zÃ¼lÃ¼yor...\n[DURUM] Derinlemesine tarama yapÄ±lÄ±yor...\n\n[ANALÄ°Z SONUCU] NEXUS CORP'un sadece nanobot projesi deÄŸil, aynÄ± zamanda kÃ¼resel finans piyasalarÄ±nÄ± manipÃ¼le eden 'Project Midas' adÄ±nda bir giriÅŸimi daha var!\n\n[GHOST] Bu bilgi Ã§ok deÄŸerli! Ama izimizi kaybettirmeliyiz. Sistemdeki loglarÄ± ve baÄŸlantÄ± kayÄ±tlarÄ±nÄ± temizlememiz ÅŸart.\n\nKomut: 'clear logs' yazarak izlerini sil",
            audio: "audio8.wav" // New audio file
        },
        {
            text: "Ä°Z SÄ°LME Ä°ÅLEMÄ° BAÅLATILIYOR...\n\n[SÄ°STEM] BaÄŸlantÄ± loglarÄ± siliniyor...\n[SÄ°STEM] GeÃ§ici dosyalar temizleniyor...\n[BAÅARILI] TÃ¼m dijital ayak izlerin silindi!\n\n[UYARI] NEXUS CORP'un gÃ¼venlik Ã¶nlemleri artÄ±rÄ±ldÄ±! Yeni bir anti-hacker protokolÃ¼ aktifleÅŸti!\n\n[GHOST] MÃ¼kemmel zamanlama. Son bir gÃ¶revimiz var: Acil durum kaÃ§Ä±ÅŸ protokolÃ¼nÃ¼ etkinleÅŸtirmek ve sistemden gÃ¼venle Ã§Ä±kmak. Aksi takdirde yakalanabiliriz!\n\nKomut: 'escape now' yazarak acil Ã§Ä±kÄ±ÅŸ protokolÃ¼nÃ¼ baÅŸlat",
            audio: "audio9.wav" // New audio file
        },
        {
            text: "ACÄ°L Ã‡IKIÅ PROTOKOLÃœ BAÅLATILIYOR...\n\n[GHOST] BaÅŸardÄ±n, genÃ§ hacker! NEXUS CORP'u ifÅŸa etme yolunda Ã§ok Ã¶nemli bir adÄ±m attÄ±n ve kendini de gÃ¼vende tuttun. DÃ¼nya sana minnettar.\n\nBu sadece baÅŸlangÄ±Ã§. Gelecekte daha bÃ¼yÃ¼k gÃ¶revler seni bekliyor olabilir.\n\nSÄ°STEM KAPATILIYOR...",
            audio: "audio10.wav" // Can loop back to the first audio or play a final one
        }
    ];

    /**
     * Types out text character by character into a specified HTML element.
     * @param {string} text The text to type.
     * @param {string} elementId The ID of the HTML element where the text will be displayed.
     * @param {function} [callback] An optional callback function to execute after typing is complete.
     */
    async function typeText(text, elementId, callback) {
        const element = document.getElementById(elementId);
        element.innerHTML = ''; // Clear existing text
        let i = 0;

        function typeChar() {
            if (i < text.length) {
                if (text[i] === '\n') {
                    element.innerHTML += '<br>'; // Handle newlines
                } else {
                    element.innerHTML += text[i];
                }
                i++;
                setTimeout(typeChar, TYPING_SPEED + Math.random() * 20); // Add slight randomness for natural typing
            } else {
                // Remove existing cursor and add a new one if input area is visible
                const existingCursor = element.querySelector('.cursor');
                if (existingCursor) existingCursor.remove();
                if (elementId === 'storyText' && document.getElementById('inputArea').style.display === 'flex') {
                    document.getElementById('commandInput').focus();
                } else {
                    element.innerHTML += '<span class="cursor">_</span>'; // Add blinking cursor
                }
                if (callback) callback();
            }
        }
        typeChar();
    }

    /**
     * Advances the story based on the current `currentStoryIndex`.
     * Handles displaying text, playing audio, and managing UI elements (input, download status).
     */
    async function startStory() {
        if (currentStoryIndex < storyTexts.length) {
            const story = storyTexts[currentStoryIndex];

            // Play audio and wait for it to finish
            try {
                await playVoiceAudio(story.audio);
            } catch (e) {
                console.log("Audio playback error, continuing with text display.");
            }

            if (currentStoryIndex === 5) { // Index after "download all" command (audio6.wav)
                isDownloading = true;
                document.getElementById('inputArea').style.display = 'none';
                document.getElementById('downloadStatus').style.display = 'block';
                document.getElementById('downloadText').innerText = story.text;
                startDownloadSimulation();
            } else if (currentStoryIndex === 0 || currentStoryIndex === storyTexts.length - 1) { // Intro and final closing stages
                typeText(story.text, 'storyText', () => {
                    document.getElementById('inputArea').style.display = 'none'; // Hide input for intro/outro
                    setTimeout(() => {
                        currentStoryIndex++;
                        if (currentStoryIndex < storyTexts.length) {
                            startStory();
                        } else {
                            alert('Tebrikler! BaÅŸarÄ±yla tÃ¼m gÃ¶revleri tamamladÄ±n ve dÃ¼nyayÄ± bÃ¼yÃ¼k bir tehlikeden korudun!');
                            goBack(); // Return to main menu after completion
                        }
                    }, 2500); // Pause before next story segment
                });
            } else {
                typeText(story.text, 'storyText', () => {
                    document.getElementById('inputArea').style.display = 'flex'; // Show input for command stages
                    document.getElementById('commandInput').focus();
                });
            }
        }
    }

    /**
     * Simulates a file download with a progress bar.
     */
    function startDownloadSimulation() {
        let startTime = Date.now();
        let interval = setInterval(() => {
            let elapsedTime = Date.now() - startTime;
            downloadProgress = (elapsedTime / DOWNLOAD_DURATION) * 100;

            document.getElementById('progressFill').style.width = `${downloadProgress}%`;
            document.getElementById('downloadText').innerText = `VERÄ°LER Ä°NDÄ°RÄ°LÄ°YOR...\nLÃ¼tfen bekle. Ä°lerleme: %${Math.floor(downloadProgress)}`;

            if (downloadProgress >= 100) {
                clearInterval(interval);
                isDownloading = false;
                document.getElementById('downloadStatus').style.display = 'none';
                document.getElementById('missionStatus').style.display = 'block';
                document.getElementById('missionStatus').innerHTML = '<span class="success">âœ… Ä°NDÄ°RME TAMAMLANDI!</span>';
                setTimeout(() => {
                    currentStoryIndex++;
                    startStory();
                    document.getElementById('missionStatus').style.display = 'none';
                }, 1500);
            }
        }, DOWNLOAD_INTERVAL);
    }

    /**
     * Handles user commands entered in the input field.
     * @param {KeyboardEvent} event The keyboard event object.
     */
    function handleCommand(event) {
        if (event.key === 'Enter' && !isDownloading) {
            const command = event.target.value.toLowerCase().trim();
            const missionStatus = document.getElementById('missionStatus');
            event.target.value = ''; // Clear input field

            let commandHandled = false;

            // Command handling logic based on current story index
            if (currentStoryIndex === 0 && command === '') { // For the first "Press Enter" prompt
                commandHandled = true;
            } else if (currentStoryIndex === 1 && command.includes('port')) {
                missionStatus.style.display = 'block';
                missionStatus.innerHTML = '<span class="success">âœ… PORT SALDIRISI BAÅARILI!</span>';
                commandHandled = true;
            } else if (currentStoryIndex === 2 && command === 'ls') {
                missionStatus.style.display = 'block';
                missionStatus.innerHTML = '<span class="success">âœ… DOSYA LÄ°STESÄ° ALINDI!</span>';
                commandHandled = true;
            } else if (currentStoryIndex === 3 && command.includes('open')) {
                missionStatus.style.display = 'block';
                missionStatus.innerHTML = '<span class="warning">âš ï¸ GÄ°ZLÄ° DOSYALAR ERÄ°ÅÄ°LDÄ°!</span>';
                commandHandled = true;
            } else if (currentStoryIndex === 4 && command.includes('download all')) {
                missionStatus.style.display = 'block';
                missionStatus.innerHTML = '<span class="success">âœ… Ä°NDÄ°RME BAÅLATILIYOR...</span>';
                commandHandled = true;
            } else if (currentStoryIndex === 6 && command.includes('analyze data')) {
                missionStatus.style.display = 'block';
                missionStatus.innerHTML = '<span class="success">âœ… VERÄ° ANALÄ°ZÄ° BAÅLADI!</span>';
                commandHandled = true;
            } else if (currentStoryIndex === 7 && command.includes('clear logs')) {
                missionStatus.style.display = 'block';
                missionStatus.innerHTML = '<span class="success">âœ… Ä°ZLER TEMÄ°ZLENÄ°YOR!</span>';
                commandHandled = true;
            } else if (currentStoryIndex === 8 && command.includes('escape now')) {
                missionStatus.style.display = 'block';
                missionStatus.innerHTML = '<span class="success">ğŸ‰ ACÄ°L Ã‡IKIÅ BAÅARILI!</span>';
                commandHandled = true;
            } else {
                // Invalid command feedback
                missionStatus.style.display = 'block';
                missionStatus.innerHTML = '<span class="error">âŒ GEÃ‡ERSÄ°Z KOMUT! Tekrar dene.</span>';
                setTimeout(() => {
                    missionStatus.style.display = 'none';
                }, 2000);
                commandHandled = false;
            }

            // Advance story if command was successfully handled
            if (commandHandled) {
                document.getElementById('inputArea').style.display = 'none'; // Hide input
                setTimeout(() => {
                    currentStoryIndex++;
                    startStory();
                    missionStatus.style.display = 'none'; // Clear mission status
                }, 1500); // Short delay before next story segment
            }
        }
    }

    // Update canvas size on window resize
    window.addEventListener('resize', () => {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    });
</script>
</body>
</html>
